<!DOCTYPE html>
<html> 
	<head> 
		<title>Google API try</title>
		<style>
		  #map {
			width: 500px;
			height: 400px;
		  }
		</style>
		<script src="https://maps.googleapis.com/maps/api/js"></script>			
		<!--<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false" type="text/javascript"></script> -->
		
		<script src="../libs/GSVPanoDepth.js-master/examples/js/jquery.min.js" type="text/javascript"></script>
		<script src="../libs/GSVPanoDepth.js-master/examples/js/jquery.base64.min.js" type="text/javascript"></script>
		<script src="../libs/GSVPanoDepth.js-master/examples/js/zpipe.min.js" type="text/javascript"></script>
		<script src="../libs/GSVPanoDepth.js-master/examples/js/GSVPano.js" type="text/javascript"></script>
		<script src="../libs/GSVPanoDepth.js-master/src/GSVPanoDepth.js" type="text/javascript"></script>	
		
		<script>
			carPathPoints= 
			[25.042224 ,121.465684 ,
			25.042171, 121.465606 ,
			25.042122, 121.465526 ,
			25.042071, 121.465441 ,
			25.042018, 121.465353 ,
			25.041964, 121.465265 ,
			25.041911, 121.465178 ,
			25.041858, 121.465091 ,
			25.041804, 121.465002 ,
			25.041752, 121.464915 ,
			25.041699, 121.464829 ,
			25.041647, 121.464743 ,
			25.041597, 121.464661 ,
			25.041570, 121.464616 ,
			25.041520, 121.464531 ,
			25.041469, 121.464445 ,
			25.041417, 121.464359 ,
			25.041366, 121.464272 ]		
			function initialize() {
				var mapCanvas = document.getElementById('map');
				var mapOptions = {
				  center: new google.maps.LatLng(carPathPoints[0], carPathPoints[1]),
				  zoom: 16,
				  mapTypeId: google.maps.MapTypeId.ROADMAP //HYBRID //SATELLITE //TERRAIN
				}
				var map = new google.maps.Map(mapCanvas, mapOptions);		
			} 
		  google.maps.event.addDomListener(window, 'load', initialize);
/*var map;
var src = 'http://localhost:8000/Desktop/osm/threejs/mrdoob-three.js-5c6ec4a/osm/westcampus.kml';
function initialize() {
  map = new google.maps.Map(document.getElementById('map'), {
    center: new google.maps.LatLng(-19.257753, 146.823688),
    zoom: 2,
    mapTypeId: google.maps.MapTypeId.TERRAIN
  });
  loadKmlLayer(src, map);
}
function loadKmlLayer(src, map) {
  var kmlLayer = new google.maps.KmlLayer(src, {
    suppressInfoWindows: true,
    preserveViewport: false,
    map: map
  });
  google.maps.event.addListener(kmlLayer, 'click', function(event) {
    var content = event.featureData.infoWindowHtml;
    var testimonial = document.getElementById('capture');
    testimonial.innerHTML = content;
  });
}
google.maps.event.addDomListener(window, 'load', initialize);*/

		</script>		
	</head>
	<body>
    <div id="street-view"></div>
    <script>

    </script>	
		<div id="map"></div>
		<!--<iframe width="560" height="315" src="https://www.youtube.com/embed/0M3Uuqw0Gn8" frameborder="0" allowfullscreen></iframe>-->
		<iframe width="560" height="315" src="https://www.youtube.com/embed/0M3Uuqw0Gn8" frameborder="0" allowfullscreen></iframe>
		
		<script>
			for(var i=0;i<carPathPoints.length/2;i++){
				var img = document.createElement( 'img' );
				document.body.appendChild( img )
				img.src = "https://maps.googleapis.com/maps/api/streetview?size=200x200&location="+carPathPoints[i*2]+","+carPathPoints[i*2+1]+"&fov=90&heading=235&pitch=10&key=AIzaSyD3VPFpxxPE9uXRo_PKDr5zuJXy8BPEj1c";
				
				document.body.appendChild( img )
			}
			
			var _panoLoader = new GSVPANO.PanoLoader({zoom: 1});
            var _depthLoader = new GSVPANO.PanoDepthLoader();

            _depthLoader.onDepthLoad = function() {
                var x, y, canvas, context, image, w, h, c;
                
                canvas = document.createElement("canvas");
                context = canvas.getContext('2d');

                w = this.depthMap.width;
                h = this.depthMap.height;

                canvas.setAttribute('width', w);
                canvas.setAttribute('height', h);
                
                image = context.getImageData(0, 0, w, h);

                for(y=0; y<h; ++y) {
                    for(x=0; x<w; ++x) {
                        c = this.depthMap.depthMap[y*w + x] / 50 * 255;
                        image.data[4*(y*w + x)    ] = c;
                        image.data[4*(y*w + x) + 1] = c;
                        image.data[4*(y*w + x) + 2] = c;
                        image.data[4*(y*w + x) + 3] = 255;
                    }
                }

                context.putImageData(image, 0, 0);

                gDepthMap = this.depthMap;

                document.body.appendChild(canvas);
            }

            _panoLoader.onPanoramaLoad = function() {
                document.body.appendChild(this.canvas);
                _depthLoader.load(this.panoId);
            };

            _panoLoader.load(new google.maps.LatLng(carPathPoints[2*3], carPathPoints[2*3+1]));			
		</script>				
	</body>
</html>